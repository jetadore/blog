# **High Performance TiDB** ç¬¬ä¸€è¯¾ ï¼ˆäº¤ä½œä¸šï¼‰

<center>

<iframe
    src="//player.bilibili.com/player.html?bvid=BV17K411T7Kd&page=1"
    sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"
    scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">
</iframe>

[ã€High Performance TiDBã€‘Lesson 01ï¼šTiDB æ•´ä½“æ¶æ„](https://www.bilibili.com/video/BV17K411T7Kd)

</center>

<!-- more -->

## ğŸ’» ä¸€ã€å‡†å¤‡å¼€å‘ç¯å¢ƒ

#### æ“ä½œç³»ç»Ÿ

```text
First, çœ‹äº†ä¸‹ä¸‰ä¸ªé¡¹ç›®åœ¨çº¿æºç 
Hmmï¼Œ æœ‰ä¸€äº›shæ–‡ä»¶
Ok, è™šæ‹Ÿæœºå®‰è£…ä¸ª Manjaro Linuxï¼Œ åˆ†é…2C8G
```

#### ç¼–è¯‘ç¯å¢ƒ

> å‚è€ƒ Â·[setting-up-your-development-environment](https://github.com/pingcap/community/blob/master/contributors/README.md#setting-up-your-development-environment)

```shell
# åŸºæœ¬éœ€è¦
sudo pacman -S git gcc clang llvm make cmake

# TiKV éœ€è¦
sudo pacman -S rustup

# TiDB & PD éœ€è¦
sudo pacman -S go

# é…ç½®goæ¨¡å—ä»£ç†
go env -w GO111MODULE=on
go env -w GOPROXY=https://goproxy.io,direct
```

## ğŸ“¥ äºŒã€ä¸‹è½½ `TiDB`, `TiKV`, `PD` æºä»£ç 

#### å‡†å¤‡å¥½å·¥ä½œç›®å½•

```shell
# Workspace
Workspace=/opt/Projects
mkdir ${Workspace} -p
cd ${Workspace}
```

#### å…‹éš†ä»£ç 

> è¿™é‡Œç›´æ¥å…‹éš†äº†å®˜æ–¹ä»“åº“ï¼Œ åé¢æäº¤ PR çš„æ—¶å€™åº”è¯¥è¦å…ˆ Fork

```shell
# TiKV
git clone --recursive https://github.com/tikv/tikv.git

# TiDB
git clone --recursive https://github.com/pingcap/tidb.git

# PD
git clone --recursive https://github.com/pingcap/pd.git
```

## ğŸ“œ ä¸‰ã€æ„å»ºå’Œæµ‹è¯•

> å…‹éš†ä»£ç åï¼Œ å…ˆæŠŠæ¯ä¸ªé¡¹ç›®éƒ½ç¼–è¯‘æ„å»ºä¸€æ¬¡ï¼Œç¡®ä¿ä¸€åˆ‡æ­£å¸¸

#### TiKV

```shell
cd ${Workspace}/tikv

# é…ç½®RUSTå·¥å…·é“¾
rustup component add rustfmt
rustup component add clippy

# æ„å»ºå’Œæµ‹è¯•
make build
# è¿™ä¸ªç¼–è¯‘æ—¶é—´æœ‰ç‚¹ä¹…
# Finished dev [unoptimized + debuginfo] target(s) in 31m 38s
# Okï¼Œç”¨æ—¶åŠä¸ªå¤šå°æ—¶

cargo check -all

```

#### PD

```shell
cd ${Workspace}/pd
make
```

#### TiDB

```shell
cd ${Workspace}/tidb
make
# è¿™ä¸ªç¼–è¯‘å®Œæˆå¯ä»¥çœ‹åˆ° Build TiDB Server successfully!
```

## ğŸš€ å››ã€å¯åŠ¨æœåŠ¡

> Okï¼Œä¸‰ä¸ªé¡¹ç›®éƒ½å·²ç»æ„å»ºé€šè¿‡ï¼Œå¯åŠ¨æœåŠ¡ï¼Œè·‘èµ·æ¥çœ‹ä¸€ä¸‹

## ğŸ“ äº”ã€ä¿®æ”¹

> éœ€æ±‚: `TiDB` å¯åŠ¨äº‹åŠ¡æ—¶, è¾“å‡ºä¸€ä¸ª`"hello transaction"`çš„æ—¥å¿— </br>

> æƒ­æ„§ï¼Œ å­¦è¿‡ Rust è¿˜æ²¡å­¦ Goï¼Œæ¥ä¸‹æ¥è¦å­¦ä¸‹ Golang äº†

#### ğŸš© å®šä½

> `//TODO å¾…æ›´æ–°`

#### âœï¸ ä¿®æ”¹å¹¶æµ‹è¯•

> `//TODO å¾…æ›´æ–°`

## âœï¸ å…­ã€é—®é¢˜æ€»ç»“

> ç›®å‰éƒ½æ˜¯ç½‘ç»œé—®é¢˜

#### crates.io æœ‰ç‚¹æ…¢(è¶…æ—¶)ï¼Œ æ›¿æ¢[ä¸­ç§‘å¤§]å›½å†…æº

```shell
tee $HOME/.cargo/config <<-'EOF'
[source.crates-io]
registry = "https://github.com/rust-lang/crates.io-index"
replace-with = 'ustc'
[source.ustc]
registry = "git://mirrors.ustc.edu.cn/crates.io-index"
EOF
```

#### æ„å»ºè¿‡ç¨‹æ‹‰å–éƒ¨åˆ† Github ä»“åº“æºç æ—¶ä¸€ç›´è¶…æ—¶é”™è¯¯

```text
Linuxç¿»å¢™æœ‰äº›éº»çƒ¦ï¼Œ ç”¨æ‰‹æœºçƒ­ç‚¹è§£å†³ã€‚
```
