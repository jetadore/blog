<!-- title: -->
<!-- created: 2021-04-16 10:11:33 -->
<!-- updated: -->
<!-- categories:   -->
<!-- tags:   -->

# MQ

> MQ（Message Queue）消息队列，是基础数据结构中“先进先出”的一种数据结构。
> 指把要传输的数据（消息）放在队列中，用队列机制来实现消息传递——生产者产生消息并把消息放入队列，然后由消费者去处理。
> 消费者可以到指定队列拉取消息，或者订阅相应的队列，由MQ服务端给其推送消息。


<!-- more -->

### 使用场景

> 消息队列中间件是分布式系统中重要的组件，主要解决应用解耦，异步消息，流量削锋等问题，实现高性能，高可用，可伸缩和最终一致性架构。

- 解耦： 一个业务需要多个模块共同实现，或者一条消息有多个系统需要对应处理，只需要主业务完成以后，发送一条MQ，其余模块消费MQ消息，即可实现业务，降低模块之间的耦合。
- 异步： 主业务执行结束后从属业务通过MQ，异步执行，减低业务的响应时间，提高用户体验。
- 削峰： 高并发情况下，业务异步处理，提供高峰期业务处理能力，避免系统瘫痪。
- 广播： 消息队列的基本功能之一
- 最终一致性： 最终一致性不是消息队列的必备特性，但确实可以依靠消息队列来做最终一致性的事情。


## 缺点

1. 系统可用性降低。依赖服务也多，服务越容易挂掉。需要考虑MQ瘫痪的情况
2. 系统复杂性提高。需要考虑消息丢失、消息重复消费、消息传递的顺序性
3. 业务一致性。主业务和从属业务一致性的处理

### 主要中间件

1. ZeroMQ
2. DistributedLog: Twitter的
3. ActiveMQ：Apache旗下的老牌消息引擎 
4. RabbitMQ： 被VMWare的SpringSource收购，后并入Pivotal
5. Kafka： Linkedin的，后来贡献给Apache了
6. RocketMQ: Alibaba的， 后来贡献给了Apache
7. Artemis： Apache的ActiveMQ下的子项目
8. Apollo： 同样为Apache的ActiveMQ的子项目的号称下一代消息引擎
9. IronMQ： 商业化的消息引擎
10. OpenMQ： 实现了JMS(Java Message Service)标准


### 总结（横向对比）
| 中间件 | ActiveMQ | RabbitMQ | RocketMQ | Kafka | 
| -------- | -------- | -------- | ----- | -------- | 
| 开发语言 | Java | Erlang | Java | Scala |
| 单机吞吐量 | 万级 | 万级 | 10万级 | 10万级 |
| 时效性 | ms级 | us级 | ms级 | ms级以内
| 可用性 | 高(主从)| 高(主从)| 非常高(分布式) | 非常高(分布式) |
| 功能特性 | 成熟的产品； 有较多的稳定； 各种协议支持较好| 并发能力强；性能极好；演示很低；管理界面较丰富 | 功能强大啊，完整；缺点是没有实现JMS接口，迁移成本高 | 支持主要的MQ功能。 大数据领域应用广|
